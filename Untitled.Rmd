---
title: "Assignment 5"
author: "Olivia Gasparoni"
date: "3/5/2020"
output:
  html_document:
    keep_md: true
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
##install.packages("readr")
##install.packages("here")
##install.packages("tidyverse")
library(tidyverse)
library(readxl) 
```

Retrieving my saved .csv file and saving it as a variable called "profanity_data"
```{r}
#dir.create(here::here("data"), recursive = TRUE)
profanity_data <- read_csv(here::here("data", "raw_movie_profanity_data_03-06-20.csv")) 
```

I created my own excel sheet with the revenues for each of the Tarantino movies I'm using, then imported the excel table using read_excel. data retrieved from: https://www.the-numbers.com/person/140200401-Quentin-Tarantino#tab=technical. This table was saved as a variable called "box_office_revenue": 
```{r}
box_office_revenue <- read_excel(here::here("data", "excel_sheet_for_boxoffice_table_03-06-20.xlsx")) 
```

I performed a count to determine how many swear words were said per movie, renaming the "n" column as "swears." I then performed an inner join on my "profanity_data" table with "box_office_revenue" table: 
```{r}
profanity_data_box <- profanity_data %>% 
  count(movie) %>% 
  rename(swears = n) %>% 
  inner_join(box_office_revenue, by = "movie") 
profanity_data_box
```

I scaled the revenue value to be in millions of dollars so a plot can be informative:
```{r}  
scaled_profanity_data_box <- profanity_data_box %>% 
  mutate(worldwide_box_office_scaled = worldwide_box_office / 1000000) %>% 
  select(-worldwide_box_office)
scaled_profanity_data_box
```

I plotted the number of swears for each movie vs the worldwide box office revenue:
```{r}
plot_swears_revenue <- scaled_profanity_data_box %>% 
  ggplot(aes(swears, worldwide_box_office_scaled, color = movie)) +
  geom_point() +
  ylab("Scaled Box Office Revenue (in millions)") +
  xlab("Number of Swears per Movie") +
  ggtitle("Box Office Revenue of Quentin Tarantino Movies vs Number of Swears") +
  theme_bw()
plot_swears_revenue
```

Writing out my summarized data table to a .csv:
```{r}
write_csv(scaled_profanity_data_box, here::here("output", "cleaned_profanity_03-07-20.csv"))
```

Saving the plot in bitmap, vector, and PDF format:
```{r}
dir.create(here::here("output", "figures"), recursive = TRUE)
ggsave(here::here("output", "figures", "plot_swears_revenue.png"), plot_swears_revenue)
ggsave(here::here("output", "figures", "plot_swears_revenue.svg"), plot_swears_revenue)
ggsave(here::here("output", "figures", "plot_swears_revenue.pdf"), plot_swears_revenue)
```
